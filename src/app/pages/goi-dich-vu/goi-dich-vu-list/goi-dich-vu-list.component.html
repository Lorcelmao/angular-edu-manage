<div class="goi-dich-vu-list">
  <div class="header-section">
    <h2>Quản lý gói dịch vụ</h2>
    <div class="header-actions">
      <span class="p-input-icon-left search-box">
        <i class="pi pi-search"></i>
        <input type="text" pInputText placeholder="Tìm kiếm..." 
               [(ngModel)]="searchValue" 
               (keyup.enter)="onSearch()"
               class="search-input">
      </span>
      
      <p-button icon="pi pi-search" 
                pTooltip="Tìm kiếm"
                tooltipPosition="top"
                styleClass="p-button-outlined mr-2"
                (onClick)="onSearch()">
      </p-button>
      
      <p-button icon="pi pi-times" 
                pTooltip="Xóa tìm kiếm"
                tooltipPosition="top"
                styleClass="p-button-outlined mr-2"
                (onClick)="clearSearch()"
                *ngIf="searchValue">
      </p-button>
      
      <p-button label="Thêm gói dịch vụ" icon="pi pi-plus" 
                (onClick)="createGoiDichVu()" styleClass="p-button-success">
      </p-button>
    </div>
  </div>

  <p-card>
    <p-table [value]="filteredGoiDichVus" 
             [loading]="loading" 
             [paginator]="true" 
             [rows]="10"
             [showCurrentPageReport]="true"
             currentPageReportTemplate="Hiển thị {first} - {last} trong tổng số {totalRecords} gói dịch vụ">
      
      <ng-template pTemplate="header">
        <tr>
          <th>STT</th>
          <th>Tên gói dịch vụ</th>
          <th>Mô tả</th>
          <th>Giá tiền</th>
          <th>Thao tác</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-goiDichVu let-rowIndex="rowIndex">
        <tr>
          <td>{{ rowIndex + 1 }}</td>
          <td>{{ goiDichVu.tenGoi }}</td>
          <td>{{ goiDichVu.moTa }}</td>
          <td>{{ formatCurrency(goiDichVu.giaGoi) }}</td>
          <td>
            <!-- Hiển thị các dịch vụ với chip và tooltip -->
            <div class="services-container">
              <!-- Dịch vụ chính -->
              <div class="service-category" *ngIf="goiDichVu.dichvuchinh?.length > 0">
                <label class="service-category-label">Dịch vụ chính:</label>
                <div class="service-chips">
                  <p-chip *ngFor="let service of goiDichVu.dichvuchinh" 
                          [label]="service.tenDichVu"
                          styleClass="main-service-chip"
                          [pTooltip]="getServiceTooltip(service)"
                          tooltipPosition="top">
                  </p-chip>
                </div>
              </div>
              
              <!-- Dịch vụ thêm -->
              <div class="service-category" *ngIf="goiDichVu.dichvuthem?.length > 0">
                <label class="service-category-label">Dịch vụ thêm:</label>
                <div class="service-chips">
                  <p-chip *ngFor="let service of goiDichVu.dichvuthem" 
                          [label]="service.tenDichVu"
                          styleClass="additional-service-chip"
                          [pTooltip]="getServiceTooltip(service)"
                          tooltipPosition="top">
                  </p-chip>
                </div>
              </div>
              
              <!-- Nội dung đặc điểm -->
              <div class="service-category" *ngIf="goiDichVu.noiDungDacDiem?.length > 0">
                <label class="service-category-label">Nội dung đặc điểm:</label>
                <div class="service-chips">
                  <p-chip *ngFor="let service of goiDichVu.noiDungDacDiem" 
                          [label]="service.tenDichVu"
                          styleClass="feature-service-chip"
                          [pTooltip]="getServiceTooltip(service)"
                          tooltipPosition="top">
                  </p-chip>
                </div>
              </div>
            </div>
          </td>
          <td>
            <div class="action-buttons">
              <p-button icon="pi pi-eye" 
                        pTooltip="Xem chi tiết"
                        tooltipPosition="top"
                        styleClass="p-button-text p-button-info"
                        (onClick)="viewGoiDichVu(goiDichVu)">
              </p-button>
              <p-button icon="pi pi-pencil" 
                        pTooltip="Chỉnh sửa"
                        tooltipPosition="top"
                        styleClass="p-button-text p-button-warning"
                        (onClick)="editGoiDichVu(goiDichVu)">
              </p-button>
              <p-button icon="pi pi-trash" 
                        pTooltip="Xóa"
                        tooltipPosition="top"
                        styleClass="p-button-text p-button-danger"
                        (onClick)="deleteGoiDichVu(goiDichVu)">
              </p-button>
            </div>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="5" class="text-center">Không có dữ liệu</td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>